<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agrolimitless & Transglobe å®šä»·çœ‹æ¿</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React 18 -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="src/styles/main.css">
    
    <!-- éªŒè¯åº“æ˜¯å¦åŠ è½½æˆåŠŸ -->
    <script>
        window.addEventListener('load', function() {
            if (typeof React === 'undefined') {
                console.error('React æœªåŠ è½½');
                document.body.innerHTML = '<div style="padding: 20px; font-family: sans-serif;"><h1 style="color: red;">é”™è¯¯ï¼šReact åº“åŠ è½½å¤±è´¥</h1><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚</p></div>';
            } else if (typeof ReactDOM === 'undefined') {
                console.error('ReactDOM æœªåŠ è½½');
                document.body.innerHTML = '<div style="padding: 20px; font-family: sans-serif;"><h1 style="color: red;">é”™è¯¯ï¼šReactDOM åº“åŠ è½½å¤±è´¥</h1><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚</p></div>';
            } else {
                console.log('React ç‰ˆæœ¬:', React.version);
                console.log('ReactDOM å·²åŠ è½½');
            }
        });
    </script>
</head>
<body>
    <div id="root"></div>

    <!-- ç»„ä»¶æ–‡ä»¶ -->
    <script type="text/babel">
/**
 * Icon ç»„ä»¶ - SVG å›¾æ ‡åº“
 * ä½¿ç”¨ React.createElement åˆ›å»º SVG å›¾æ ‡
 */

const Icon = ({ name, size = 24, className = "", ...props }) => {
    const h = React.createElement;
    
    const icons = {
        Calculator: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('rect', { width: 16, height: 20, x: 4, y: 2, rx: 2 }),
            h('line', { x1: 8, y1: 6, x2: 16, y2: 6 }),
            h('line', { x1: 8, y1: 10, x2: 16, y2: 10 }),
            h('line', { x1: 8, y1: 14, x2: 16, y2: 14 }),
            h('line', { x1: 8, y1: 18, x2: 16, y2: 18 })
        ),
        Globe: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('circle', { cx: 12, cy: 12, r: 10 }),
            h('line', { x1: 2, y1: 12, x2: 22, y2: 12 }),
            h('path', { d: 'M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z' })
        ),
        TrendingUp: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('polyline', { points: '23 6 13.5 15.5 8.5 10.5 1 18' }),
            h('polyline', { points: '17 6 23 6 23 12' })
        ),
        MapPin: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z' }),
            h('circle', { cx: 12, cy: 10, r: 3 })
        ),
        Settings: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z' }),
            h('circle', { cx: 12, cy: 12, r: 3 })
        ),
        CheckCircle2: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14' }),
            h('polyline', { points: '22 4 12 14.01 9 11.01' })
        ),
        Plus: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('line', { x1: 12, y1: 5, x2: 12, y2: 19 }),
            h('line', { x1: 5, y1: 12, x2: 19, y2: 12 })
        ),
        Trash2: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M3 6h18' }),
            h('path', { d: 'M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6' }),
            h('path', { d: 'M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2' }),
            h('line', { x1: 10, y1: 11, x2: 10, y2: 17 }),
            h('line', { x1: 14, y1: 11, x2: 14, y2: 17 })
        ),
        Save: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z' }),
            h('polyline', { points: '17 21 17 13 7 13 7 21' }),
            h('polyline', { points: '7 3 7 8 15 8' })
        ),
        ShieldCheck: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M20 13c0 5-3.5 7.5-7.66 8.94a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z' }),
            h('path', { d: 'm9 12 2 2 4-4' })
        ),
        Truck: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('path', { d: 'M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2' }),
            h('path', { d: 'M15 18H9' }),
            h('path', { d: 'M19 18h2a1 1 0 0 0 1-1v-3h-3' }),
            h('path', { d: 'M18 12h2' }),
            h('path', { d: 'M3 18h1' }),
            h('path', { d: 'M6 18h1' })
        ),
        Clock: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('circle', { cx: 12, cy: 12, r: 10 }),
            h('polyline', { points: '12 6 12 12 16 14' })
        ),
        Info: (size) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', ...props },
            h('circle', { cx: 12, cy: 12, r: 10 }),
            h('line', { x1: 12, y1: 16, x2: 12, y2: 12 }),
            h('line', { x1: 12, y1: 8, x2: 12.01, y2: 8 })
        )
    };
    
    const IconComponent = icons[name];
    if (!IconComponent) return null;
    return h('span', { className: `inline-flex items-center justify-center ${className}` }, IconComponent(size));
};


/**
 * App ç»„ä»¶ - ä¸»åº”ç”¨ç»„ä»¶
 * å®šä»·çœ‹æ¿ä¸»ç•Œé¢
 */

const { useState, useMemo } = React;
const h = React.createElement;

        const App = () => {
            // --- æ ¸å¿ƒé…ç½®ä¸çŠ¶æ€ ---
            const productCategories = {
                'è°·ç‰©ç±»': ['å°éº¦', 'å¤§éº¦', 'ç‰ç±³', 'èéº¦', 'é»‘éº¦', 'å¤§ç±³', 'å°ç±³', 'ç‡•éº¦'],
                'è±†ç±»': ['è±Œè±†', 'æ‰è±†'],
                'æ²¹ç±½ç±»': ['äºšéº»ç±½', 'æ²¹è‘µ', 'è‘µä»', 'æ²¹èœç±½', 'å¤§è±†'],
                'é¥²æ–™ç±»': ['è±†ç²•', 'è±†é¥¼', 'èœç±½é¥¼', 'èœç±½ç²•', 'äºšéº»ç±½é¥¼', 'äºšéº»ç±½ç²•', 'è‘µç²•', 'ç”œèœç²•']
            };

            const [exchangeRate, setExchangeRate] = useState(11.37); 
            const [usdCnyRate, setUsdCnyRate] = useState(7.11);
            const [category, setCategory] = useState('è°·ç‰©ç±»');
            const [subType, setSubType] = useState('å°éº¦');
            const [policyName, setPolicyName] = useState('å¸¸è§„è¿›å£ç¨æ”¶æ”¿ç­–');
            const [saveStatus, setSaveStatus] = useState(null);
            
            // 1. æµ·å¤–æ®µå‚æ•°
            const [farmPriceRub, setFarmPriceRub] = useState(35000); 
            const [overseaLogistics1, setOverseaLogistics1] = useState(1346.15); 
            const [unit1, setUnit1] = useState('RUB/t'); 
            const [overseaLogistics2, setOverseaLogistics2] = useState(0); 
            const [unit2, setUnit2] = useState('RUB/t'); 

            const [exportExtras, setExportExtras] = useState([
                { id: 1, name: 'è£…è½¦è´¹', value: 1200, unit: 'RUB/ton' },
                { id: 2, name: 'å•†æ£€è´¹', value: 300, unit: 'RUB/ton' }
            ]);

            // 2. å›½å†…ç¨åŠ¡æ”¿ç­–
            const [vatRate, setVatRate] = useState(9); 
            const [dutyRate, setDutyRate] = useState(0); 

            // 3. å›½å†…æ®µè®¡ç®—å‚æ•°
            const [importPriceRub, setImportPriceRub] = useState(37000); 
            const [importPriceUnit, setImportPriceUnit] = useState('RUB/t'); 
            const [intlFreightUsd, setIntlFreightUsd] = useState(2000); 
            const [domesticShortHaulCny, setDomesticShortHaulCny] = useState(4680); 
            const [sellingPriceCny, setSellingPriceCny] = useState(5500); 

            // å›½å†…åŠ¨æ€æ‚è´¹åˆ—è¡¨
            const [domesticExtras, setDomesticExtras] = useState([
                { id: 1, name: 'æ¸¯æ‚è´¹', value: 1500, unit: 'CNY/æŸœ' },
                { id: 2, name: 'ä»£ç†è´¹', value: 944, unit: 'CNY/æŸœ' }
            ]);

            const [totalContainers, setTotalContainers] = useState(10);
            const [tonsPerContainer, setTonsPerContainer] = useState(26);
            const [collectionDays, setCollectionDays] = useState(45); 
            const [interestRate, setInterestRate] = useState(6.0); 

            // --- æ“ä½œæ–¹æ³• ---
            const handleCategoryChange = (val) => {
                setCategory(val);
                const firstSub = productCategories[val][0];
                setSubType(firstSub);
                setPolicyName(`${firstSub}è¿›å£ç¨æ”¶æ”¿ç­–`);
            };

            const savePolicy = () => {
                const policyData = {
                    timestamp: new Date().toISOString(),
                    policyName,
                    targetProduct: { category, subType },
                    rates: { dutyRate, vatRate }
                };
                console.log("Saving Policy with Product Association:", policyData);
                setSaveStatus(`å·²æˆåŠŸä¿å­˜ [${subType}] çš„ç¨æ”¶æ”¿ç­–: å…³ç¨${dutyRate}%, å¢å€¼ç¨${vatRate}%`);
                setTimeout(() => setSaveStatus(null), 3500);
            };

            const addExportExtra = () => setExportExtras([...exportExtras, { id: Date.now(), name: '', value: 0, unit: 'RUB/ton' }]);
            const deleteExportExtra = (id) => setExportExtras(exportExtras.filter(item => item.id !== id));
            const updateExportExtra = (id, field, value) => setExportExtras(exportExtras.map(item => item.id === id ? { ...item, [field]: value } : item));
            const toggleExportExtraUnit = (id) => setExportExtras(exportExtras.map(item => item.id === id ? { ...item, unit: item.unit === 'RUB/ton' ? 'RUB/container' : 'RUB/ton' } : item));

            const addDomesticExtra = () => setDomesticExtras([...domesticExtras, { id: Date.now(), name: '', value: 0, unit: 'CNY/æŸœ' }]);
            const deleteDomesticExtra = (id) => setDomesticExtras(domesticExtras.filter(item => item.id !== id));
            const updateDomesticExtra = (id, field, value) => setDomesticExtras(domesticExtras.map(item => item.id === id ? { ...item, [field]: value } : item));
            const toggleDomesticExtraUnit = (id) => setDomesticExtras(domesticExtras.map(item => item.id === id ? { ...item, unit: item.unit === 'CNY/æŸœ' ? 'CNY/ton' : 'CNY/æŸœ' } : item));

            // --- æ ¸å¿ƒè®¡ç®—å¼•æ“ ---
            const results = useMemo(() => {
                const totalTons = totalContainers * tonsPerContainer;
                const tpc = tonsPerContainer || 1;
                
                const log1 = unit1 === 'RUB/t' ? overseaLogistics1 : overseaLogistics1 / tpc;
                const log2 = unit2 === 'RUB/t' ? overseaLogistics2 : overseaLogistics2 / tpc;
                const exportExtrasTotalRub = exportExtras.reduce((sum, item) => sum + (item.unit === 'RUB/ton' ? item.value : item.value / tpc), 0);
                const russianArrivalPriceRub = farmPriceRub + log1 + log2 + exportExtrasTotalRub;
                const russianArrivalPriceCny = russianArrivalPriceRub / (exchangeRate || 1);

                const normalizedImportPriceRubPerTon = importPriceUnit === 'RUB/t' ? importPriceRub : importPriceRub / tpc;
                const overseaProfitRubCalculated = normalizedImportPriceRubPerTon - russianArrivalPriceRub;

                const importValueCny = normalizedImportPriceRubPerTon / (exchangeRate || 1);
                const intlFreightCnyPerTon = (intlFreightUsd * usdCnyRate) / tpc;
                
                const customValueCny = importValueCny + intlFreightCnyPerTon;
                const dutyCny = customValueCny * (dutyRate / 100);
                const vatCny = (customValueCny + dutyCny) * (vatRate / 100);
                
                const domesticLogisticsBase = (domesticShortHaulCny / tpc);
                const dynamicExtrasTotal = domesticExtras.reduce((sum, item) => sum + (item.unit === 'CNY/ton' ? item.value : item.value / tpc), 0);
                const domesticLogisticsCnyPerTon = domesticLogisticsBase + dynamicExtrasTotal;

                const baseLandingPrice = customValueCny + dutyCny + vatCny + domesticLogisticsCnyPerTon;
                const interestExpense = (baseLandingPrice * (interestRate / 100) * (collectionDays / 365));
                const fullCost = baseLandingPrice + interestExpense;

                return {
                    totalTons,
                    russianArrivalPriceRub,
                    russianArrivalPriceCny,
                    overseaProfitRubCalculated,
                    importValueCny,
                    intlFreightCnyPerTon,
                    customValueCny, 
                    dutyCny,
                    vatCny,
                    domesticLogisticsBase,
                    dynamicExtrasTotal,
                    domesticLogisticsCnyPerTon,
                    baseLandingPrice,
                    interestExpense,
                    fullCost,
                    profitNoInterest: sellingPriceCny - baseLandingPrice,
                    profitWithInterest: sellingPriceCny - fullCost,
                    totalCapital: baseLandingPrice * totalTons
                };
            }, [
                farmPriceRub, overseaLogistics1, unit1, overseaLogistics2, unit2, exportExtras,
                exchangeRate, usdCnyRate, importPriceRub, importPriceUnit, intlFreightUsd, 
                tonsPerContainer, dutyRate, vatRate, domesticShortHaulCny, 
                totalContainers, collectionDays, interestRate, sellingPriceCny,
                domesticExtras
            ]);

            return h('div', { className: "min-h-screen bg-[#f4f7fe] p-6 font-sans text-slate-800" },
                // Header
                h('div', { className: "max-w-7xl mx-auto flex justify-between items-center mb-6" },
                    h('div', null,
                        h('h1', { className: "text-2xl font-bold flex items-center gap-2 text-[#1a2b4b]" },
                            h('div', { className: "bg-blue-600 p-1 rounded text-white" }, h(Icon, { name: 'Calculator', size: 20 })),
                            "Agrolimitless & Transglobe å®šä»·çœ‹æ¿"
                        ),
                        h('p', { className: "text-slate-400 italic text-sm underline decoration-blue-200" }, "è·¨å¢ƒä¾›åº”é“¾å…¨é“¾è·¯æ ¸ç®—ç³»ç»Ÿ")
                    ),
                    h('div', { className: "flex bg-white p-2 rounded-xl shadow-sm border border-slate-200 gap-4 items-center" },
                        h('div', { className: "text-right" },
                            h('p', { className: "text-[10px] text-slate-400 font-bold uppercase tracking-tighter" }, "ç³»ç»Ÿè®¡ç®—çŠ¶æ€"),
                            h('p', { className: "text-xs font-bold text-emerald-500 flex items-center gap-1 justify-end" },
                                h(Icon, { name: 'CheckCircle2', size: 12 }),
                                " å‚æ•°å®æ—¶å¯¹é½"
                            )
                        )
                    )
                ),

                h('div', { className: "max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-12 gap-6" },
                    // Top Info Cards
                    h('div', { className: "col-span-1 md:col-span-12 grid grid-cols-1 md:grid-cols-3 gap-6" },
                        h('div', { className: "bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4 hover:shadow-md transition-shadow" },
                            h('div', { className: "w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 shadow-inner" }, h(Icon, { name: 'Globe', size: 24 })),
                            h('div', null,
                                h('p', { className: "text-xs text-blue-400 font-medium tracking-tight uppercase" }, "æ±‡ç‡ (CNY/RUB)"),
                                h('input', {
                                    type: "number",
                                    value: exchangeRate,
                                    onChange: (e) => setExchangeRate(Number(e.target.value)),
                                    className: "text-2xl font-bold w-full bg-transparent outline-none focus:text-blue-600 transition-colors"
                                })
                            )
                        ),
                        h('div', { className: "bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4 hover:shadow-md transition-shadow" },
                            h('div', { className: "w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center text-slate-400" }, h(Icon, { name: 'TrendingUp', size: 24 })),
                            h('div', null,
                                h('p', { className: "text-xs text-slate-400 font-medium tracking-tight uppercase" }, "æ±‡ç‡ (USD/CNY)"),
                                h('input', {
                                    type: "number",
                                    value: usdCnyRate,
                                    onChange: (e) => setUsdCnyRate(Number(e.target.value)),
                                    className: "text-2xl font-bold w-full bg-transparent outline-none focus:text-blue-600 transition-colors"
                                })
                            )
                        ),
                        h('div', { className: "bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex items-center justify-between hover:shadow-md transition-shadow" },
                            h('div', { className: "flex items-center gap-4" },
                                h('div', { className: "w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-500" }, h(Icon, { name: 'MapPin', size: 24 })),
                                h('div', null,
                                    h('p', { className: "text-xs text-slate-400 font-medium tracking-tight" }, "æµ·å¤–åˆ°ç«™é¢„ä¼°"),
                                    h('div', { className: "flex flex-col" },
                                        h('p', { className: "text-2xl font-bold leading-none" },
                                            results.russianArrivalPriceRub.toLocaleString(undefined, { maximumFractionDigits: 0 }),
                                            h('span', { className: "text-[10px] text-slate-400 font-normal" }, " RUB/t")
                                        ),
                                        h('p', { className: "text-sm font-bold text-indigo-500 mt-1" },
                                            "â‰ˆ Â¥ ",
                                            results.russianArrivalPriceCny.toLocaleString(undefined, { maximumFractionDigits: 2 })
                                        )
                                    )
                                )
                            )
                        )
                    ),

                    // Sidebar Controls
                    h('div', { className: "col-span-1 md:col-span-4 space-y-6" },
                        h('div', { className: "bg-white p-6 rounded-3xl shadow-sm border border-slate-100" },
                            h('h3', { className: "text-lg font-bold flex items-center gap-2 mb-6 text-[#1a2b4b]" },
                                h(Icon, { name: 'Settings', size: 18, className: "text-blue-500" }),
                                " è®¡ç®—æ ¸å¿ƒå‚æ•°"
                            ),
                            h('div', { className: "space-y-4" },
                                h('div', { className: "space-y-2" },
                                    h('label', { className: "text-xs text-slate-400 font-bold uppercase" }, "ğŸ·ï¸ äº§å“ç±»ç›®ä¸è§„æ ¼"),
                                    h('div', { className: "grid grid-cols-2 gap-2" },
                                        h('select', {
                                            className: "p-3 bg-[#f8faff] border border-slate-200 rounded-xl text-xs font-bold w-full focus:ring-2 focus:ring-blue-100",
                                            value: category,
                                            onChange: (e) => handleCategoryChange(e.target.value)
                                        },
                                            Object.keys(productCategories).map(cat => h('option', { key: cat, value: cat }, cat))
                                        ),
                                        h('select', {
                                            className: "p-3 bg-blue-600 text-white border-none rounded-xl text-xs font-bold w-full focus:ring-2 focus:ring-blue-300",
                                            value: subType,
                                            onChange: (e) => setSubType(e.target.value)
                                        },
                                            productCategories[category].map(item => h('option', { key: item, value: item }, item))
                                        )
                                    )
                                ),

                                // 1. æµ·å¤–æ®µè®¡ç®—å‚æ•°
                                h('div', { className: "bg-orange-50/50 p-4 rounded-2xl border border-orange-100 space-y-3 shadow-sm" },
                                    h('h4', { className: "text-sm font-bold text-orange-600 flex items-center gap-2 italic uppercase tracking-wider underline decoration-orange-200 decoration-2 underline-offset-4" },
                                        h(Icon, { name: 'Globe', size: 14 }),
                                        " 1. æµ·å¤–æ®µè®¡ç®—å‚æ•°"
                                    ),
                                    h('div', { className: "space-y-2" },
                                        h('div', null,
                                            h('label', { className: "text-[10px] text-slate-500 font-bold uppercase tracking-tighter" }, "å†œåœºé‡‡è´­ä»· (RUB/t)"),
                                            h('input', {
                                                type: "number",
                                                value: farmPriceRub,
                                                onChange: e => setFarmPriceRub(Number(e.target.value)),
                                                className: "w-full p-2 bg-white border border-slate-200 rounded-lg text-sm font-bold shadow-sm focus:ring-2 focus:ring-orange-200 outline-none"
                                            })
                                        ),
                                        h('div', { className: "grid grid-cols-2 gap-2" },
                                            h('div', null,
                                                h('div', { className: "flex justify-between items-center mb-1" },
                                                    h('label', { className: "text-[10px] text-slate-400 font-bold" }, "çŸ­é©³è´¹1"),
                                                    h('button', {
                                                        onClick: () => setUnit1(unit1 === 'RUB/t' ? 'RUB/æŸœ' : 'RUB/t'),
                                                        className: "text-[8px] bg-orange-100 px-1 rounded font-bold text-orange-600"
                                                    }, unit1)
                                                ),
                                                h('input', {
                                                    type: "number",
                                                    value: overseaLogistics1,
                                                    onChange: e => setOverseaLogistics1(Number(e.target.value)),
                                                    className: "w-full p-2 bg-white border border-slate-200 rounded-lg text-xs shadow-sm"
                                                })
                                            ),
                                            h('div', null,
                                                h('div', { className: "flex justify-between items-center mb-1" },
                                                    h('label', { className: "text-[10px] text-slate-400 font-bold" }, "çŸ­é©³è´¹2"),
                                                    h('button', {
                                                        onClick: () => setUnit2(unit2 === 'RUB/t' ? 'RUB/æŸœ' : 'RUB/t'),
                                                        className: "text-[8px] bg-orange-100 px-1 rounded font-bold text-orange-600"
                                                    }, unit2)
                                                ),
                                                h('input', {
                                                    type: "number",
                                                    value: overseaLogistics2,
                                                    onChange: e => setOverseaLogistics2(Number(e.target.value)),
                                                    className: "w-full p-2 bg-white border border-slate-200 rounded-lg text-xs shadow-sm"
                                                })
                                            )
                                        ),
                                        h('div', { className: "space-y-2" },
                                            exportExtras.map(item =>
                                                h('div', { key: item.id, className: "bg-white/60 p-2 rounded-xl border border-orange-50 space-y-2 shadow-sm" },
                                                    h('div', { className: "flex gap-2 items-center" },
                                                        h('input', {
                                                            type: "text",
                                                            value: item.name,
                                                            onChange: e => updateExportExtra(item.id, 'name', e.target.value),
                                                            placeholder: "è´¹ç”¨é¡¹ç›®",
                                                            className: "flex-1 p-2 bg-white border border-slate-200 rounded-lg text-xs"
                                                        }),
                                                        h('button', {
                                                            onClick: () => deleteExportExtra(item.id),
                                                            className: "text-slate-300 hover:text-rose-400 transition-colors"
                                                        }, h(Icon, { name: 'Trash2', size: 14 }))
                                                    ),
                                                    h('div', { className: "flex gap-2 items-center" },
                                                        h('input', {
                                                            type: "number",
                                                            value: item.value,
                                                            onChange: e => updateExportExtra(item.id, 'value', Number(e.target.value)),
                                                            className: "flex-1 p-2 bg-white border border-slate-200 rounded-lg text-xs font-bold text-orange-800"
                                                        }),
                                                        h('button', {
                                                            onClick: () => toggleExportExtraUnit(item.id),
                                                            className: `px-2 py-1.5 rounded-lg text-[10px] font-black border transition-all ${item.unit === 'RUB/container' ? 'bg-orange-600 text-white border-orange-600' : 'bg-white text-orange-600 border-orange-200'}`
                                                        }, item.unit === 'RUB/container' ? 'RUB/æŸœ' : 'RUB/t')
                                                    )
                                                )
                                            ),
                                            h('button', {
                                                onClick: addExportExtra,
                                                className: "w-full py-2 border-2 border-dashed border-orange-200 rounded-xl text-orange-400 text-[10px] font-black hover:bg-orange-100 transition-colors shadow-sm"
                                            },
                                                h(Icon, { name: 'Plus', size: 14, className: "inline mr-1" }),
                                                "æ·»åŠ æµ·å¤–æ‚è´¹"
                                            )
                                        )
                                    )
                                ),

                                // 2. è¿›å£ç¨æ”¶æ”¿ç­–
                                h('div', { className: "bg-blue-50 p-4 rounded-3xl border border-blue-200 space-y-4 shadow-sm ring-4 ring-blue-50 relative overflow-hidden" },
                                    saveStatus && h('div', { className: "absolute top-0 left-0 right-0 bg-emerald-500 text-white text-[10px] font-black py-1 px-4 flex items-center gap-2 animate-in slide-in-from-top duration-300 z-20 shadow-lg" },
                                        h(Icon, { name: 'CheckCircle2', size: 12 }),
                                        saveStatus
                                    ),
                                    h('div', { className: "flex justify-between items-center border-b border-blue-200 pb-2" },
                                        h('h4', { className: "text-sm font-black text-blue-700 flex items-center gap-2 italic uppercase tracking-wider" },
                                            h(Icon, { name: 'ShieldCheck', size: 16 }),
                                            " 2. è¿›å£ç¨æ”¶æ”¿ç­–"
                                        ),
                                        h('button', {
                                            onClick: savePolicy,
                                            className: "bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white p-1.5 rounded-lg flex items-center gap-1 transition-all active:scale-95 shadow-lg shadow-blue-200",
                                            title: `ä¿å­˜å½“å‰ [${subType}] çš„ç¨æ”¶æ”¿ç­–é…ç½®`
                                        },
                                            h(Icon, { name: 'Save', size: 14 }),
                                            h('span', { className: "text-[10px] font-bold" }, "ä¿å­˜æ”¿ç­–")
                                        )
                                    ),
                                    h('div', { className: "space-y-3" },
                                        h('div', { className: "flex flex-col gap-1" },
                                            h('label', { className: "text-[10px] text-blue-500 font-black uppercase tracking-widest block" }, "æ”¿ç­–åç§°"),
                                            h('div', { className: "flex items-center gap-2" },
                                                h('input', {
                                                    type: "text",
                                                    value: policyName,
                                                    onChange: e => setPolicyName(e.target.value),
                                                    className: "flex-1 p-2.5 bg-white border border-blue-200 rounded-xl text-xs font-bold text-blue-800 focus:ring-2 focus:ring-blue-400 outline-none transition-all shadow-sm"
                                                }),
                                                h('div', { className: "group relative" },
                                                    h(Icon, { name: 'Info', size: 14, className: "text-blue-300 cursor-help" }),
                                                    h('div', { className: "absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-48 p-2 bg-[#1a2b4b] text-white text-[9px] rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-30 shadow-xl border border-blue-400" },
                                                        "ç‚¹å‡»\"ä¿å­˜æ”¿ç­–\"å°†æŠŠå½“å‰ç¨ç‡ä¸äº§å“è§„æ ¼ ",
                                                        h('span', { className: "text-blue-300" }, `[${subType}]`),
                                                        " å…³è”ã€‚"
                                                    )
                                                )
                                            )
                                        ),
                                        h('div', { className: "grid grid-cols-2 gap-3" },
                                            h('div', { className: "bg-white p-3 rounded-2xl border border-blue-100 shadow-sm hover:border-blue-300 transition-colors" },
                                                h('label', { className: "text-[10px] text-rose-400 font-black uppercase tracking-tighter block mb-1" }, "å…³ç¨ç¨ç‡ %"),
                                                h('input', {
                                                    type: "number",
                                                    value: dutyRate,
                                                    onChange: e => setDutyRate(Number(e.target.value)),
                                                    className: "w-full bg-transparent text-lg font-black text-rose-600 focus:ring-0 outline-none"
                                                })
                                            ),
                                            h('div', { className: "bg-white p-3 rounded-2xl border border-blue-100 shadow-sm hover:border-blue-300 transition-colors" },
                                                h('label', { className: "text-[10px] text-rose-400 font-black uppercase tracking-tighter block mb-1" }, "å¢å€¼ç¨ç‡ %"),
                                                h('input', {
                                                    type: "number",
                                                    value: vatRate,
                                                    onChange: e => setVatRate(Number(e.target.value)),
                                                    className: "w-full bg-transparent text-lg font-black text-rose-600 focus:ring-0 outline-none"
                                                })
                                            )
                                        ),
                                        h('div', { className: "p-2 bg-blue-100/50 rounded-lg border border-blue-100" },
                                            h('p', { className: "text-[9px] text-blue-500 font-bold leading-tight" },
                                                "å…³è”äº§å“çŠ¶æ€: ",
                                                h('span', { className: "text-blue-700 underline" }, `${category} > ${subType}`)
                                            )
                                        )
                                    )
                                ),

                                // 3. å›½å†…æ®µè®¡ç®—å‚æ•°
                                h('div', { className: "bg-orange-50/50 p-4 rounded-2xl border border-orange-100 space-y-3 shadow-sm" },
                                    h('h4', { className: "text-sm font-bold text-orange-600 flex items-center gap-2 italic uppercase tracking-wider underline decoration-orange-200 decoration-2 underline-offset-4" },
                                        h(Icon, { name: 'Truck', size: 14 }),
                                        " 3. å›½å†…æ®µè®¡ç®—å‚æ•°"
                                    ),
                                    h('div', { className: "space-y-3" },
                                        h('div', { className: "bg-white p-3 rounded-2xl border border-orange-200 shadow-sm hover:shadow-md transition-shadow" },
                                            h('div', { className: "flex justify-between items-center mb-1 text-[10px] text-orange-400 font-black uppercase tracking-wider" },
                                                h('span', null, "è¿›å£ç»“ç®—è´§å€¼ (RUB)"),
                                                h('button', {
                                                    onClick: () => setImportPriceUnit(importPriceUnit === 'RUB/t' ? 'RUB/æŸœ' : 'RUB/t'),
                                                    className: "bg-orange-50 px-2 py-0.5 rounded text-[9px] text-orange-500 font-bold border border-orange-100"
                                                }, importPriceUnit === 'RUB/t' ? 'Rub/t' : 'Rub/æŸœ')
                                            ),
                                            h('input', {
                                                type: "number",
                                                value: importPriceRub,
                                                onChange: e => setImportPriceRub(Number(e.target.value)),
                                                className: "w-full p-1 bg-transparent border-none text-xl font-black text-orange-800 focus:ring-0 outline-none"
                                            })
                                        ),
                                        h('div', null,
                                            h('label', { className: "text-[10px] text-slate-500 font-bold block mb-1 uppercase tracking-tighter" }, "ä¸­æ¬§ç­åˆ—è¿è´¹ (USD/æŸœ)"),
                                            h('input', {
                                                type: "number",
                                                value: intlFreightUsd,
                                                onChange: e => setIntlFreightUsd(Number(e.target.value)),
                                                className: "w-full p-2 bg-white border border-slate-200 rounded-lg text-sm font-bold shadow-sm focus:ring-2 focus:ring-orange-100 outline-none"
                                            })
                                        ),
                                        h('div', null,
                                            h('label', { className: "text-[10px] text-slate-500 font-bold block mb-1 uppercase tracking-tighter" }, "å›½å†…é™†è¿/çŸ­é©³è´¹ (CNY/æŸœ)"),
                                            h('input', {
                                                type: "number",
                                                value: domesticShortHaulCny,
                                                onChange: e => setDomesticShortHaulCny(Number(e.target.value)),
                                                className: "w-full p-2 bg-white border border-slate-200 rounded-lg text-sm font-bold text-orange-800 shadow-sm focus:ring-2 focus:ring-orange-100 outline-none"
                                            })
                                        ),
                                        h('div', { className: "space-y-2 pt-2" },
                                            h('p', { className: "text-[10px] text-orange-600 font-black uppercase tracking-widest border-l-2 border-orange-300 pl-2" }, "å›½å†…æ‚è´¹æ˜ç»† (CNY)"),
                                            domesticExtras.map(item =>
                                                h('div', { key: item.id, className: "bg-white/60 p-2 rounded-xl border border-orange-50 space-y-2 shadow-sm" },
                                                    h('div', { className: "flex gap-2 items-center" },
                                                        h('input', {
                                                            type: "text",
                                                            value: item.name,
                                                            onChange: e => updateDomesticExtra(item.id, 'name', e.target.value),
                                                            placeholder: "é¡¹ç›®",
                                                            className: "flex-1 p-2 bg-white border border-slate-200 rounded-lg text-xs"
                                                        }),
                                                        h('button', {
                                                            onClick: () => deleteDomesticExtra(item.id),
                                                            className: "text-slate-300 hover:text-rose-400 transition-colors"
                                                        }, h(Icon, { name: 'Trash2', size: 14 }))
                                                    ),
                                                    h('div', { className: "flex gap-2 items-center" },
                                                        h('input', {
                                                            type: "number",
                                                            value: item.value,
                                                            onChange: e => updateDomesticExtra(item.id, 'value', Number(e.target.value)),
                                                            className: "flex-1 p-2 bg-white border border-slate-200 rounded-lg text-xs font-bold text-orange-800"
                                                        }),
                                                        h('button', {
                                                            onClick: () => toggleDomesticExtraUnit(item.id),
                                                            className: `px-2 py-1.5 rounded-lg text-[10px] font-black border transition-all ${item.unit === 'CNY/æŸœ' ? 'bg-orange-600 text-white border-orange-600' : 'bg-white text-orange-600 border-orange-200'}`
                                                        }, item.unit === 'CNY/æŸœ' ? 'æŸœ' : 'å¨')
                                                    )
                                                )
                                            ),
                                            h('button', {
                                                onClick: addDomesticExtra,
                                                className: "w-full py-2 border-2 border-dashed border-orange-200 rounded-xl text-orange-400 text-[10px] font-black hover:bg-orange-100 transition-colors shadow-sm"
                                            },
                                                h(Icon, { name: 'Plus', size: 14, className: "inline mr-1" }),
                                                "æ·»åŠ å›½å†…æ‚è´¹"
                                            )
                                        ),
                                        h('div', { className: "pt-2" },
                                            h('label', { className: "text-[10px] text-orange-700 font-black mb-1 block uppercase text-center tracking-widest italic" }, "ğŸ¯ ç›®æ ‡é”€å”®å•ä»· (CNY/t)"),
                                            h('input', {
                                                type: "number",
                                                value: sellingPriceCny,
                                                onChange: e => setSellingPriceCny(Number(e.target.value)),
                                                className: "w-full p-3 bg-orange-600 text-white rounded-2xl text-xl font-black text-center shadow-xl border-none ring-4 ring-orange-100 outline-none focus:scale-105 transition-transform"
                                            })
                                        )
                                    )
                                )
                            )
                        )
                    ),

                    // Main Result Area
                    h('div', { className: "col-span-1 md:col-span-8 space-y-6" },
                        h('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
                            h('div', { className: "bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100 hover:scale-[1.02] transition-transform" },
                                h('p', { className: "text-slate-400 text-[10px] mb-1 font-bold uppercase tracking-tight" }, "åŸºç¡€å•ä»· (ä¸å«æ¯)"),
                                h('div', { className: "flex items-baseline" },
                                    h('span', { className: "text-sm font-bold mr-1 text-slate-400" }, "Â¥"),
                                    h('span', { className: "text-2xl font-black text-[#1a2b4b] tracking-tighter" },
                                        results.baseLandingPrice.toLocaleString(undefined, { maximumFractionDigits: 2 })
                                    )
                                )
                            ),
                            h('div', { className: "bg-[#1a2b4b] p-6 rounded-[2rem] shadow-xl text-white hover:scale-[1.02] transition-transform" },
                                h('p', { className: "text-slate-400 text-[10px] mb-1 font-bold uppercase tracking-tight" }, "æ€»è®¡å•ä»· (å«æ¯)"),
                                h('div', { className: "flex items-baseline" },
                                    h('span', { className: "text-sm font-bold mr-1 text-slate-600" }, "Â¥"),
                                    h('span', { className: "text-2xl font-black tracking-tighter" },
                                        results.fullCost.toLocaleString(undefined, { maximumFractionDigits: 2 })
                                    )
                                )
                            ),
                            h('div', { className: "p-6 rounded-[2rem] bg-emerald-50 border border-emerald-100 shadow-sm hover:scale-[1.02] transition-transform" },
                                h('p', { className: "text-emerald-700 text-[10px] mb-1 font-bold uppercase tracking-tight" }, "æ¯›åˆ© (ä¸å«æ¯)"),
                                h('div', { className: "text-emerald-600 flex items-baseline" },
                                    h('span', { className: "text-sm font-bold mr-1" }, "Â¥"),
                                    h('span', { className: "text-2xl font-black tracking-tighter" },
                                        results.profitNoInterest.toLocaleString(undefined, { maximumFractionDigits: 0 })
                                    )
                                )
                            ),
                            h('div', { className: "p-6 rounded-[2rem] bg-blue-50 border border-blue-100 shadow-sm hover:scale-[1.02] transition-transform" },
                                h('p', { className: "text-blue-700 text-[10px] mb-1 font-bold uppercase tracking-tight" }, "é¢„è®¡å‡€åˆ© (å«æ¯)"),
                                h('div', { className: "text-blue-600 flex items-baseline" },
                                    h('span', { className: "text-sm font-bold mr-1" }, "Â¥"),
                                    h('span', { className: "text-2xl font-black tracking-tighter" },
                                        results.profitWithInterest.toLocaleString(undefined, { maximumFractionDigits: 0 })
                                    )
                                )
                            )
                        ),

                        // æ€»æ¡ˆæ ¸ç®—
                        h('div', { className: "bg-gradient-to-br from-blue-600 to-blue-700 rounded-[2.5rem] p-10 text-white flex flex-col md:flex-row items-center justify-between shadow-2xl shadow-blue-200 gap-8" },
                            h('div', { className: "flex gap-10" },
                                h('div', { className: "text-center md:text-left" },
                                    h('p', { className: "text-[10px] text-blue-200 mb-2 font-bold uppercase tracking-widest italic" }, "æ‰¹æ¬¡æ€»æŸœæ•°"),
                                    h('input', {
                                        type: "number",
                                        value: totalContainers,
                                        onChange: e => setTotalContainers(Number(e.target.value)),
                                        className: "text-5xl font-black bg-transparent border-b-4 border-blue-400 w-24 outline-none text-white focus:border-white transition-all"
                                    })
                                ),
                                h('div', { className: "text-center md:text-left" },
                                    h('p', { className: "text-[10px] text-blue-200 mb-2 font-bold uppercase tracking-widest italic" }, "å•æŸœè£…è½½ (å¨)"),
                                    h('input', {
                                        type: "number",
                                        value: tonsPerContainer,
                                        onChange: e => setTonsPerContainer(Number(e.target.value)),
                                        className: "text-5xl font-black bg-transparent border-b-4 border-blue-400 w-24 outline-none text-white focus:border-white transition-all"
                                    })
                                )
                            ),
                            h('div', { className: "text-center md:text-right border-l-0 md:border-l border-blue-500/50 pl-0 md:pl-10" },
                                h('p', { className: "text-[10px] text-blue-100 mb-2 font-black uppercase tracking-[0.2em] italic" }, "å…¨æ¡ˆèµ„é‡‘å ç”¨é¢åº¦ (CNY)"),
                                h('span', { className: "text-5xl font-black tabular-nums drop-shadow-lg" },
                                    "Â¥ ",
                                    results.totalCapital.toLocaleString(undefined, { maximumFractionDigits: 0 })
                                )
                            )
                        ),

                        // å®¡è®¡æ„æˆæ¨¡å—
                        h('div', { className: "bg-white p-10 rounded-[2.5rem] shadow-sm border border-slate-100" },
                            h('h4', { className: "text-sm font-bold text-slate-800 mb-8 flex justify-between items-center italic" },
                                h('span', { className: "flex items-center gap-2" },
                                    h('div', { className: "w-1.5 h-6 bg-blue-600 rounded-full" }),
                                    " å®¡è®¡çº§æˆæœ¬æ‹†è§£ (CNY/T)"
                                ),
                                h('span', { className: "text-[10px] text-slate-400 font-medium tracking-tight" },
                                    "ç»‘å®šäº§å“: ",
                                    h('b', { className: "text-blue-600" }, subType),
                                    ` (${policyName})`
                                )
                            ),
                            h('div', { className: "space-y-4" },
                                [
                                    { label: 'è¿›å£ç»“ç®—è´§å€¼ (äººæ°‘å¸æŠ˜ç®—)', val: results.importValueCny, color: 'bg-orange-500', isHighlight: true, calc: `${importPriceRub} / ${exchangeRate}` },
                                    { label: 'å›½é™…ç­åˆ—è´¹ç”¨ (è¿è´¹æŠ˜ç®—)', val: results.intlFreightCnyPerTon, color: 'bg-indigo-400', calc: `(${intlFreightUsd} * ${usdCnyRate}) / ${tonsPerContainer}` },
                                    { label: 'å…³ç¨å®Œç¨ä»·æ ¼ (CNY/å¨)', val: results.customValueCny, color: 'bg-purple-600', isTitle: true, calc: `è´§å€¼ + è¿è´¹` },
                                    { label: 'å…³ç¨ (åŸºäºè®¾å®šæ”¿ç­–)', val: results.dutyCny, color: 'bg-rose-500', calc: `å®Œç¨ä»·æ ¼ * ${dutyRate}%` },
                                    { label: 'è¿›å£å¢å€¼ç¨ (åŸºäºè®¾å®šæ”¿ç­–)', val: results.vatCny, color: 'bg-rose-400', calc: `(å®Œç¨ä»·æ ¼ + å…³ç¨) * ${vatRate}%` },
                                    { label: 'å›½å†…æ®µæ‚è´¹åˆè®¡', val: results.domesticLogisticsCnyPerTon, color: 'bg-blue-500', isHighlight: true, calc: `${results.domesticLogisticsBase.toFixed(1)} (çŸ­é©³) + ${results.dynamicExtrasTotal.toFixed(1)} (æ‚è´¹)` }
                                ].map((item, idx) =>
                                    h('div', { key: idx, className: `flex items-center justify-between p-3 rounded-2xl transition-all ${item.isHighlight || item.isTitle ? 'bg-slate-50 shadow-inner' : 'hover:bg-slate-50/50'}` },
                                        h('div', { className: "flex items-center gap-4" },
                                            h('div', { className: `w-2.5 h-2.5 rounded-full ${item.color} shadow-sm` }),
                                            h('span', { className: `text-xs font-black ${item.isTitle ? 'text-purple-700' : 'text-slate-600'}` }, item.label)
                                        ),
                                        h('div', { className: "flex-1 border-b-2 border-dotted border-slate-200 mx-6 opacity-30" }),
                                        h('div', { className: "text-right" },
                                            h('span', { className: `text-base font-black ${item.isTitle ? 'text-purple-600' : item.isHighlight ? 'text-blue-700' : 'text-slate-800'}` },
                                                "Â¥ ",
                                                item.val.toLocaleString(undefined, { minimumFractionDigits: 3, maximumFractionDigits: 3 })
                                            ),
                                            item.calc && h('p', { className: "text-[9px] font-bold text-slate-300 tracking-tighter mt-0.5 uppercase" },
                                                "= ",
                                                item.calc
                                            )
                                        )
                                    )
                                ),
                                h('div', { className: "pt-8 mt-6 border-t-2 border-slate-100 flex justify-between items-center" },
                                    h('div', { className: "flex flex-col" },
                                        h('span', { className: "text-xs font-black text-slate-400 italic uppercase tracking-widest" }, "LANDING-PRICE-BASE"),
                                        h('span', { className: "text-xl font-black text-slate-800 italic" }, "è½åœ°åŸºç¡€æˆæœ¬ä»·")
                                    ),
                                    h('span', { className: "text-4xl font-black text-[#1a2b4b] drop-shadow-sm" },
                                        "Â¥ ",
                                        results.baseLandingPrice.toLocaleString(undefined, { minimumFractionDigits: 2 })
                                    )
                                )
                            )
                        ),

                        // è´¢åŠ¡åˆ©æ¯æ æ†
                        h('div', { className: "bg-white p-10 rounded-[2.5rem] shadow-sm border border-slate-100 grid grid-cols-1 md:grid-cols-2 gap-10 hover:shadow-lg transition-shadow" },
                            h('div', { className: "space-y-8" },
                                h('div', { className: "flex items-center gap-4" },
                                    h('div', { className: "w-12 h-12 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 shadow-inner" }, h(Icon, { name: 'Clock', size: 24 })),
                                    h('h4', { className: "text-sm font-black text-slate-800 uppercase tracking-widest italic border-b-2 border-indigo-100 pb-1" }, "èµ„é‡‘è´¢åŠ¡æ æ†æ ¸ç®—")
                                ),
                                h('div', { className: "space-y-5" },
                                    h('div', { className: "flex justify-between items-end" },
                                        h('span', { className: "text-[10px] text-slate-400 font-black uppercase" }, "èµ„é‡‘å‘¨è½¬å‘¨æœŸ (å›æ¬¾å¤©æ•°)"),
                                        h('span', { className: "text-indigo-600 text-lg font-black" },
                                            collectionDays,
                                            h('span', { className: "text-[10px] font-normal uppercase" }, " Days")
                                        )
                                    ),
                                    h('input', {
                                        type: "range",
                                        min: "0",
                                        max: "150",
                                        value: collectionDays,
                                        onChange: e => setCollectionDays(Number(e.target.value)),
                                        className: "w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-indigo-600"
                                    })
                                ),
                                h('div', { className: "space-y-5" },
                                    h('div', { className: "flex justify-between items-end" },
                                        h('span', { className: "text-[10px] text-slate-400 font-black uppercase" }, "å¹´åŒ–åˆ©ç‡"),
                                        h('span', { className: "text-indigo-600 text-lg font-black" },
                                            interestRate,
                                            "% ",
                                            h('span', { className: "text-[10px] font-normal uppercase" }, "APR")
                                        )
                                    ),
                                    h('input', {
                                        type: "range",
                                        min: "0",
                                        max: "15",
                                        step: "0.1",
                                        value: interestRate,
                                        onChange: e => setInterestRate(Number(e.target.value)),
                                        className: "w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-indigo-600"
                                    })
                                )
                            ),
                            h('div', { className: "bg-gradient-to-br from-indigo-600 to-indigo-700 rounded-[2rem] p-8 text-white flex flex-col items-center justify-center shadow-2xl shadow-indigo-200 relative overflow-hidden group hover:scale-[1.02] transition-transform" },
                                h('div', { className: "absolute top-0 right-0 p-6 opacity-10 group-hover:scale-125 transition-transform" }, h(Icon, { name: 'TrendingUp', size: 120 })),
                                h('p', { className: "text-[10px] opacity-70 mb-3 font-black uppercase italic tracking-[0.3em] z-10 text-center" }, "èµ„é‡‘å ç”¨è´¢åŠ¡æˆæœ¬ (å•å¨)"),
                                h('div', { className: "flex items-baseline mb-6 z-10" },
                                    h('span', { className: "text-2xl font-bold mr-1 opacity-50" }, "Â¥"),
                                    h('span', { className: "text-6xl font-black tracking-tighter" },
                                        results.interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2 })
                                    )
                                )
                            )
                        )
                    )
                )
            );
        };


/**
 * å…¥å£æ–‡ä»¶
 * åˆå§‹åŒ– React åº”ç”¨
 */

// ç­‰å¾…æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ
function renderApp() {
    try {
        console.log('å¼€å§‹æ¸²æŸ“åº”ç”¨...');
        const rootElement = document.getElementById('root');
        if (!rootElement) {
            console.error('Root element not found');
            return;
        }

        // æ£€æŸ¥ React å’Œ ReactDOM æ˜¯å¦å·²åŠ è½½
        if (typeof React === 'undefined') {
            console.error('React æœªåŠ è½½');
            rootElement.innerHTML = '<div style="padding: 20px; color: red; font-family: sans-serif;"><h2>é”™è¯¯ï¼šReact åº“æœªæ­£ç¡®åŠ è½½</h2><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚</p></div>';
            return;
        }
        
        if (typeof ReactDOM === 'undefined') {
            console.error('ReactDOM æœªåŠ è½½');
            rootElement.innerHTML = '<div style="padding: 20px; color: red; font-family: sans-serif;"><h2>é”™è¯¯ï¼šReactDOM åº“æœªæ­£ç¡®åŠ è½½</h2><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚</p></div>';
            return;
        }

        console.log('React ç‰ˆæœ¬:', React.version);
        console.log('ReactDOM å·²åŠ è½½');

        const h = React.createElement;

        // æ£€æŸ¥ App ç»„ä»¶æ˜¯å¦å®šä¹‰
        if (typeof App === 'undefined') {
            console.error('App ç»„ä»¶æœªå®šä¹‰');
            rootElement.innerHTML = '<div style="padding: 20px; color: red; font-family: sans-serif;"><h2>é”™è¯¯ï¼šApp ç»„ä»¶æœªå®šä¹‰</h2><p>è¯·æ£€æŸ¥ä»£ç æ˜¯å¦æ­£ç¡®ã€‚</p></div>';
            return;
        }

        // ä½¿ç”¨ React 18 çš„ createRoot API
        if (ReactDOM.createRoot) {
            console.log('ä½¿ç”¨ React 18 createRoot API');
            const root = ReactDOM.createRoot(rootElement);
            root.render(h(App));
        } else {
            console.log('ä½¿ç”¨ React 17 render API');
            // é™çº§åˆ° React 17 çš„ render API
            ReactDOM.render(h(App), rootElement);
        }
        console.log('åº”ç”¨æ¸²æŸ“å®Œæˆ');
    } catch (error) {
        console.error('Error rendering app:', error);
        console.error('Error stack:', error.stack);
        const rootElement = document.getElementById('root');
        if (rootElement) {
            rootElement.innerHTML = '<div style="padding: 20px; color: red; font-family: sans-serif;"><h2>æ¸²æŸ“é”™è¯¯</h2><p>' + error.message + '</p><pre style="background: #f0f0f0; padding: 10px; overflow: auto;">' + error.stack + '</pre></div>';
        }
    }
}

// ç­‰å¾…é¡µé¢å’Œ Babel å¤„ç†å®Œæˆ
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        // ç»™ Babel ä¸€äº›æ—¶é—´å¤„ç†ä»£ç 
        setTimeout(renderApp, 100);
    });
} else {
    // é¡µé¢å·²åŠ è½½ï¼Œç»™ Babel ä¸€äº›æ—¶é—´å¤„ç†ä»£ç 
    setTimeout(renderApp, 100);
}

    </script>
</body>
</html>
