# 成本拆解UI结构调整

## 📋 修改说明

按照计算层级结构重新组织成本拆解UI显示，使计算关系更加清晰。

---

## ✅ 新的UI结构

### 1. 关税完税价格 (customValueCny)
**主项显示**：
- 标签：`关税完税价格 (customValueCny)`
- 计算公式：`进口结算货值 (CNY/t) + 国际运费 (CNY/t)`

**子项显示**（缩进，左侧边框）：
- **进口结算货值 (CNY/t)**
  - 计算公式：`进口结算货值 (RUB) / 汇率`
- **国际运费 (CNY/t)**
  - 计算公式：`(国际运费 (USD) × USD/CNY汇率) / 单柜装载量`

### 2. 关税 (dutyCny)
**单项显示**：
- 标签：`关税 (dutyCny)`
- 计算公式：`完税价格 × 关税税率`

### 3. 增值税 (vatCny)
**单项显示**：
- 标签：`增值税 (vatCny)`
- 计算公式：`(完税价格 + 关税) × 增值税率`

### 4. 国内物流总费用 (domesticLogisticsCnyPerTon)
**主项显示**：
- 标签：`国内物流总费用 (domesticLogisticsCnyPerTon)`
- 计算公式：`国内短驳费 + 国内杂费合计`

**子项显示**（缩进，左侧边框）：
- **国内短驳费**
  - 计算公式：`短驳费 / 单柜装载量`
- **国内杂费合计**
  - 计算公式：`Σ(各杂费项目)`

---

## 🎨 UI设计特点

### 分组显示（Group）
- **主项**：
  - 较大的圆点标识（`w-3 h-3`）
  - 较大的字体（`text-sm`）
  - 背景色：`bg-slate-50`，带边框（`border-2 border-purple-100`）
  - 价格字体：`text-lg`
  
- **子项**：
  - 较小的圆点标识（`w-2 h-2`）
  - 较小的字体（`text-xs`）
  - 左侧边框（`border-l-2 border-slate-200`）
  - 缩进显示（`ml-6 pl-4`）
  - 价格字体：`text-sm`

### 单项显示（Item）
- 标准大小的圆点标识（`w-3 h-3`）
- 标准字体（`text-sm`）
- 价格字体：`text-lg`

---

## 📊 视觉层级

```
┌─────────────────────────────────────────┐
│ 关税完税价格 (customValueCny)    ¥ X.XXX │
│ 计算公式: 进口结算货值 + 国际运费        │
│ │                                        │
│ ├─ 进口结算货值 (CNY/t)         ¥ X.XXX │
│ │  计算公式: XXX / XXX                  │
│ │                                        │
│ └─ 国际运费 (CNY/t)            ¥ X.XXX │
│    计算公式: (XXX * XXX) / XXX          │
├─────────────────────────────────────────┤
│ 关税 (dutyCny)                  ¥ X.XXX │
│ 计算公式: 完税价格 × 关税税率           │
├─────────────────────────────────────────┤
│ 增值税 (vatCny)                 ¥ X.XXX │
│ 计算公式: (完税价格 + 关税) × 增值税率  │
├─────────────────────────────────────────┤
│ 国内物流总费用 (...)             ¥ X.XXX │
│ 计算公式: 国内短驳费 + 国内杂费合计     │
│ │                                        │
│ ├─ 国内短驳费                   ¥ X.XXX │
│ │  计算公式: 短驳费 / XXX               │
│ │                                        │
│ └─ 国内杂费合计                  ¥ X.XXX │
│    计算公式: Σ(各杂费项目)              │
└─────────────────────────────────────────┘
```

---

## 🔧 技术实现

### 数据结构

```javascript
{
    type: 'group',  // 或 'item'
    label: '标签名称',
    val: 数值,
    color: '颜色类名',
    isTitle: true,  // 可选
    isHighlight: true,  // 可选
    calc: '计算公式',
    children: [     // 仅当 type === 'group' 时
        {
            label: '子项标签',
            val: 数值,
            color: '颜色类名',
            calc: '计算公式'
        }
    ]
}
```

### 渲染逻辑

1. **分组项（type === 'group'）**：
   - 渲染主项（带边框和背景）
   - 渲染子项列表（缩进，左侧边框）

2. **单项（type === 'item'）**：
   - 渲染标准单项

---

## 📝 修改的文件

- ✅ `src/components/CostBreakdown.js`

---

## 🎯 改进效果

### 改进前
- 所有项目平级显示
- 计算关系不够清晰
- 难以理解层级结构

### 改进后
- ✅ 清晰的层级结构
- ✅ 主项和子项明确区分
- ✅ 计算公式一目了然
- ✅ 视觉层次更加分明

---

**修改完成时间**: 2026年2月14日
